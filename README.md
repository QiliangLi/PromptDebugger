# PromptCraft 调试工具

## 1. 系统架构概览
- **前端/交互层**：使用 Streamlit 构建响应式界面。
- **后端逻辑层**：包含提示词渲染引擎、LLM调用代理（模拟/真实）、自动迭代状态机。
- **数据层**：使用本地 JSON 文件系统存储会话历史和配置预设。

## 2. 环境准备
需要安装以下 Python 库：

```bash
pip install streamlit openai textdistance jinja2 pandas
```

## 3. 功能使用指南

### 如何运行
1. 将上述代码保存为 `app.py`。
2. 在终端运行：  
   ```bash
   streamlit run app.py
   ```
   浏览器将自动打开 http://localhost:8501。

## 4. 功能亮点说明

### 4.1 区分"可变部分" (Requirement 1 & 7)
- **实现**：使用 Jinja2 模板引擎 ({{variable}})。
- **操作**：在左侧输入框写 {{source}}，在右侧 JSON 框定义 {"source": "..."}。

### 4.2 LLM配置面板 (Requirement 1)
- **实现**：侧边栏 Settings。
- **亮点**：独立区分了执行模型、评价模型和优化模型。你可以用便宜的模型执行，用强的模型（如 GPT-4）来评价和优化。

### 4.3 迭代与双路径优化 (Requirement 2 & 3)
- **自动路径**：点击"开始调试"，系统会在循环中调用 optimize 函数自动修改 Prompt。
- **人工路径**：在结果详情页底部，提供了"基于此版本手动修改"的文本框，允许人类介入。
- **智能回滚**：当新版本的评分低于旧版本时，系统会标记状态为 rolled_back，并在下一次迭代中使用旧版本作为基底。

### 4.4 调试控制台与日志 (Requirement 1 & 4)
- 界面底部有 **运行日志** Tab，实时显示每一步的操作（渲染、调用、评分）。

### 4.5 差异对比 (Requirement 5)
- 在 **提示词差异对比** Tab 中，使用颜色高亮显示了两个版本之间的文字增删变化。

### 4.6 模拟模式 (Reliability)
- 为了方便你在没有 API Key 的情况下测试界面逻辑，默认开启了 Mock Mode（侧边栏顶部开关）。关闭后需在代码中填入 Key 或配置环境变量。